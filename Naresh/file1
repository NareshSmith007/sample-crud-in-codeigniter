Some changes in the coode
